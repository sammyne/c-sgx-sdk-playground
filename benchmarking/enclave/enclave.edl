enclave {
  include "sgx_tcrypto.h"

  trusted {
    public sgx_status_t ecall_aes128_gcm_encrypt(
      [out,size=msg_len] uint8_t *ciphertext, [out,size=16] uint8_t *tag,
      [in,size=16] const uint8_t *key, [in,size=msg_len] const uint8_t* msg, size_t msg_len,
      [in,size=iv_len] const uint8_t *iv, size_t iv_len);

    public sgx_status_t ecall_sha256(
      [out] sgx_sha256_hash_t *hash,
      [user_check] const uint8_t* msg, size_t msg_len);
  };
};